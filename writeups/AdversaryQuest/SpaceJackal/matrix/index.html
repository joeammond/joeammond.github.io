
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Joe Ammond (pugpug)">
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.3">
    
    
      
        <title>Space Jackal - Matrix - CrowdStrike Adversary Quest CTF writeup</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3b61ea93.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/print.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#space-jackal-matrix" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="CrowdStrike Adversary Quest CTF writeup" class="md-header-nav__button md-logo" aria-label="CrowdStrike Adversary Quest CTF writeup">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            CrowdStrike Adversary Quest CTF writeup
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Space Jackal - Matrix
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CrowdStrike Adversary Quest CTF writeup" class="md-nav__button md-logo" aria-label="CrowdStrike Adversary Quest CTF writeup">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    CrowdStrike Adversary Quest CTF writeup
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href="http://ammond.org" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../the-proclamation/" class="md-nav__link">
      Space Jackal - The Proclamation
    </a>
  </li>

    
      
      
      


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Space Jackal - Matrix
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Space Jackal - Matrix
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#challenge-description" class="md-nav__link">
    Challenge description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#message-1-welcome-on-board" class="md-nav__link">
    Message 1: Welcome on board!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-2-lets-fight-back" class="md-nav__link">
    Message 2: Let's fight back!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-3-flagz" class="md-nav__link">
    Message 3: FLAGZ!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#answer" class="md-nav__link">
    Answer
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../injector/" class="md-nav__link">
      Space Jackal - Injector
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../CatapultSpider/muchsad/" class="md-nav__link">
      Catapult Spider - Much Sad
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../CatapultSpider/veryprotocol/" class="md-nav__link">
      Catapult Spider - Very Protocol
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../conclusion/" class="md-nav__link">
      Conclusion
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#challenge-description" class="md-nav__link">
    Challenge description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#message-1-welcome-on-board" class="md-nav__link">
    Message 1: Welcome on board!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-2-lets-fight-back" class="md-nav__link">
    Message 2: Let's fight back!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-3-flagz" class="md-nav__link">
    Message 3: FLAGZ!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#answer" class="md-nav__link">
    Answer
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset"><a class="md-content__button md-icon" download href="matrix.pdf" title="PDF Export"><svg style="height: 1.2rem; width: 1.2rem;" viewBox="0 0 384 512" xmlns="http://www.w3.org/2000/svg"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg></a>
              
                
                
                <h1 id="space-jackal-matrix">SPACE JACKAL - Matrix<a class="headerlink" href="#space-jackal-matrix" title="Permanent link">#</a></h1>
<p>A bit more difficult of a challenge: reverse-engineering a custom encryption program
to decipher messages from the SPACE JACKAL hidden forum.</p>
<h2 id="challenge-description">Challenge description<a class="headerlink" href="#challenge-description" title="Permanent link">#</a></h2>
<p><img alt="Matarix" src="../../img/matrix/00.png" /></p>
<blockquote>
<p>With the help of your analysis, we got onto the trail of the group and found their <a href="http://spacesftw5q4uyamog5qgcf75a5hbhmr2g24jqsdcpjnew63zkq7ueyd.onion/">hidden forum on the Deep Dark Web</a>. Unfortunately, all messages are encrypted. While we believe that we have found their encryption tool, we are unsure how to decrypt these messages. Can you assist?</p>
</blockquote>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">#</a></h2>
<p>The 'forum' with the messages is a <code>TOR</code> site: <a href="http://spacesftw5q4uyamog5qgcf75a5hbhmr2g24jqsdcpjnew63zkq7ueyd.onion/">http://spacesftw5q4uyamog5qgcf75a5hbhmr2g24jqsdcpjnew63zkq7ueyd.onion/</a>. Using <a href="https://tails.boum.org/">TAILS</a> &amp; the <code>TOR Browser</code>, we can retrieve the messages:</p>
<p><img alt="SPACE JACKAL messages" src="../../img/matrix/01.png" /></p>
<p><strong>Welcome on board!</strong>
<div class="highlight"><pre><span></span><code>259F8D014A44C2BE8FC573EAD944BA63 21BB02BE026D599AA43B7AE224E221CF 00098D47F8FFF3A7DBFF21376FF4EB79
B01B8877012536C10394DF7A943731F8 9117B49349E078809EA2EECE4AA86D84 4E94DF7A265574A379EB17E4E1905DB8
49280BD0040C23C98B05F160905DB849 280B6CB9DFECC6C09A0921314BD94ABF 3049280B5BFD8953CA73C8D1F6D0040C
1B967571354BAAB7992339507BBB59C6 5CDA5335A7D575C970F1C9D0040C23C9 8B08F78D3F40B198659B4CB137DEB437
08EB47FB978EF4EB7919BF3E97EA5F40 9F5CF66370141E345024AC7BB966AEDF 5F870F407BB9666F7C4DC85039CBD819
994515C4459F1B96750716906CB9DF34 5106F58B3448E12B87AFE754C0DD802C 41C25C7AAAFF7900B574FC6867EA35C5
BB4E51542C2D0B5645FB9DB1C6D12C8E F62524A12D5D5E622CD443E02515E7EB 991ACCC0C08CE8783F7E2BAD4B16D758
530C79003E5ED61DFE2BE70F50A6F9CA 288C
</code></pre></div></p>
<p><strong>Let's fight back!</strong>
<div class="highlight"><pre><span></span><code>259F8D014A44C2BE8F7FA3BC3656CFB3 DF178DEA8313DBD33A8BAC2CD4432D66 3BC75139ECC6C0FFFBB38FB17F448C08
17BF508074D723AAA722D4239328C6B3 7F57C0A5249EA4E79B780DF081E997C0 6058F702E2BF9F50C4EC1B5966DF27EC
56149F253325CFE57A00B57494692921 94F383A3535024ACA7009088E70E6128 9BD30B2FCFE57A00B5749469292194F3
83A3533BAB08CA7FD9DC778386803149 280BE0895C0984C6DC77838C2085B10B 3ED0040C3759B05029F8085EDBE26DE3
DF25AA87CE0BBBD1169B780D1BCAA097 9A6412CCBE5B68BD2FB780C5DBA34137 C102DBE48D3F0AE471B77387E7FA8BEC
305671785D725930C3E1D05B8BD884C0 A5246EF0BF468E332E0E70009CCCB4C2 ED84137DB4C2EDE078807E1616AA9A7F
4055844821AB16F842
</code></pre></div></p>
<p><strong>FLAGZ!</strong>
<div class="highlight"><pre><span></span><code>259F8D014A44C2BE8FC50A5A2C1EF0C1 3D7F2E0E70009CCCB4C2ED84137DB4C2 EDE078807E1616C266D5A15DC6DDB60E
4B7337E851E739A61EED83D2E06D6184 11DF61222EED83D2E06D612C8EB5294B CD4954E0855F4D71D0F06D05EE
</code></pre></div></p>
<p>We're given the the Python used to encrypt the messages, but no indication of the key used to 
encrypt:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&#39;&#39;&#39;              ,</span>
<span class="sd">                /|      ,</span>
<span class="sd">   ,--.________/ /-----/|-------------------------------------.._</span>
<span class="sd">  (    /_/_/_/_  |--------- DEATH TO ALL TABS ---------------&lt;  _`&gt;</span>
<span class="sd">   `--´        \ \-----\|-------------------------------------&#39;&#39;´</span>
<span class="sd">                \|      &#39;</span>
<span class="sd">&#39;&#39;&#39;</span><span class="c1">#             &#39;</span>
<span class="k">assert</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">def</span> <span class="nf">die</span><span class="p">(</span><span class="n">E</span><span class="p">):</span>
<span class="c1">#    print(F&#39;E:&#39;,E,file=sys.stderr)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">T</span><span class="o">=</span><span class="k">lambda</span> <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">I</span><span class="p">:</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">I</span><span class="o">+</span><span class="n">B</span><span class="o">*</span><span class="n">F</span><span class="o">*</span><span class="n">G</span><span class="o">+</span><span class="n">C</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">H</span><span class="o">-</span><span class="n">G</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">C</span><span class="o">-</span><span class="n">H</span><span class="o">*</span><span class="n">F</span><span class="o">*</span><span class="n">A</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">B</span><span class="o">&amp;</span><span class="mi">255</span>
<span class="k">def</span> <span class="nf">U</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">R</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="o">*</span><span class="n">K</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">256</span><span class="p">)</span>
    <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">I</span><span class="o">=</span><span class="n">K</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">R</span><span class="o">*</span><span class="n">V</span><span class="o">%</span><span class="mi">256</span> <span class="k">for</span> <span class="n">V</span> <span class="ow">in</span>
     <span class="p">[</span><span class="n">E</span><span class="o">*</span><span class="n">I</span><span class="o">-</span><span class="n">F</span><span class="o">*</span><span class="n">H</span><span class="p">,</span><span class="n">C</span><span class="o">*</span><span class="n">H</span><span class="o">-</span><span class="n">B</span><span class="o">*</span><span class="n">I</span><span class="p">,</span><span class="n">B</span><span class="o">*</span><span class="n">F</span><span class="o">-</span><span class="n">C</span><span class="o">*</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="o">*</span><span class="n">G</span><span class="o">-</span><span class="n">D</span><span class="o">*</span><span class="n">I</span><span class="p">,</span><span class="n">A</span><span class="o">*</span><span class="n">I</span><span class="o">-</span><span class="n">C</span><span class="o">*</span><span class="n">G</span><span class="p">,</span><span class="n">C</span><span class="o">*</span><span class="n">D</span><span class="o">-</span><span class="n">A</span><span class="o">*</span><span class="n">F</span><span class="p">,</span><span class="n">D</span><span class="o">*</span><span class="n">H</span><span class="o">-</span><span class="n">E</span><span class="o">*</span><span class="n">G</span><span class="p">,</span><span class="n">B</span><span class="o">*</span><span class="n">G</span><span class="o">-</span><span class="n">A</span><span class="o">*</span><span class="n">H</span><span class="p">,</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">-</span><span class="n">B</span><span class="o">*</span><span class="n">D</span><span class="p">]]</span>
<span class="k">def</span> <span class="nf">C</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">):</span>
    <span class="n">B</span><span class="o">=</span><span class="k">lambda</span> <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">:</span><span class="nb">bytes</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">B</span><span class="o">*</span><span class="n">Y</span><span class="o">+</span><span class="n">C</span><span class="o">*</span><span class="n">Z</span><span class="o">&amp;</span><span class="mh">0xFF</span><span class="p">,</span>
        <span class="n">D</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">E</span><span class="o">*</span><span class="n">Y</span><span class="o">+</span><span class="n">F</span><span class="o">*</span><span class="n">Z</span><span class="o">&amp;</span><span class="mh">0xFF</span><span class="p">,</span><span class="n">G</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">H</span><span class="o">*</span><span class="n">Y</span><span class="o">+</span><span class="n">I</span><span class="o">*</span><span class="n">Z</span><span class="o">&amp;</span><span class="mh">0xFF</span><span class="p">))</span>
    <span class="n">N</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">R</span><span class="o">=</span><span class="n">N</span><span class="o">%</span><span class="mi">3</span>
    <span class="n">R</span><span class="o">=</span><span class="n">R</span> <span class="ow">and</span> <span class="mi">3</span><span class="o">-</span><span class="n">R</span>
    <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">R</span><span class="o">*</span><span class="sa">B</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span>
    <span class="k">return</span> <span class="sa">B</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="o">*</span><span class="n">K</span><span class="p">,</span><span class="o">*</span><span class="n">W</span><span class="p">)</span> <span class="k">for</span> <span class="n">W</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">iter</span><span class="p">(</span><span class="n">M</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="sa">B</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">die</span><span class="p">(</span><span class="s1">&#39;FOOL&#39;</span><span class="p">)</span>
<span class="n">K</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">==</span><span class="mi">9</span> <span class="ow">and</span> <span class="n">T</span><span class="p">(</span><span class="o">*</span><span class="n">K</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">die</span><span class="p">(</span><span class="s1">&#39;INVALID&#39;</span><span class="p">)</span>
<span class="n">M</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
    <span class="n">M</span><span class="o">=</span><span class="sa">B</span><span class="s1">&#39;SPACEARMY&#39;</span><span class="o">+</span><span class="nb">bytes</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">U</span><span class="p">(</span><span class="n">K</span><span class="p">),</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">M</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
    <span class="n">M</span><span class="p">[:</span><span class="mi">9</span><span class="p">]</span><span class="o">==</span><span class="sa">B</span><span class="s1">&#39;SPACEARMY&#39;</span> <span class="ow">or</span> <span class="n">die</span><span class="p">(</span><span class="s1">&#39;INVALID&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">9</span><span class="p">:]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
<p>From the code, we can determine a few things about how the program works:</p>
<ul>
<li>The program expects two arguments:</li>
</ul>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">die</span><span class="p">(</span><span class="s1">&#39;FOOL&#39;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<ul>
<li>The key is in the <code>ASCII</code> character set:</li>
</ul>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">K</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<ul>
<li>The key is 9 characters long, and the lowest bit of the key is <code>1</code>:</li>
</ul>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">==</span><span class="mi">9</span> <span class="ow">and</span> <span class="n">T</span><span class="p">(</span><span class="o">*</span><span class="n">K</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">die</span><span class="p">(</span><span class="s1">&#39;INVALID&#39;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<ul>
<li>And very importantly, we know that the first 9 characters of every message is the string 
<code>SPACEARMY</code>:</li>
</ul>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
<span class="hll">    <span class="n">M</span><span class="o">=</span><span class="sa">B</span><span class="s1">&#39;SPACEARMY&#39;</span><span class="o">+</span><span class="nb">bytes</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</span>    <span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">U</span><span class="p">(</span><span class="n">K</span><span class="p">),</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">M</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="hll">    <span class="n">M</span><span class="p">[:</span><span class="mi">9</span><span class="p">]</span><span class="o">==</span><span class="sa">B</span><span class="s1">&#39;SPACEARMY&#39;</span> <span class="ow">or</span> <span class="n">die</span><span class="p">(</span><span class="s1">&#39;INVALID&#39;</span><span class="p">)</span>
</span>    <span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">9</span><span class="p">:]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
<p>This gives a set of known plaintext-&gt;ciphertext values that we can use to derive the key 
and decrypt the rest of the message. The encryption is performed by the function <code>C()</code>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">C</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">):</span>
<span class="hll">    <span class="n">B</span><span class="o">=</span><span class="k">lambda</span> <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">:</span><span class="nb">bytes</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">B</span><span class="o">*</span><span class="n">Y</span><span class="o">+</span><span class="n">C</span><span class="o">*</span><span class="n">Z</span><span class="o">&amp;</span><span class="mh">0xFF</span><span class="p">,</span>
</span><span class="hll">        <span class="n">D</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">E</span><span class="o">*</span><span class="n">Y</span><span class="o">+</span><span class="n">F</span><span class="o">*</span><span class="n">Z</span><span class="o">&amp;</span><span class="mh">0xFF</span><span class="p">,</span><span class="n">G</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">H</span><span class="o">*</span><span class="n">Y</span><span class="o">+</span><span class="n">I</span><span class="o">*</span><span class="n">Z</span><span class="o">&amp;</span><span class="mh">0xFF</span><span class="p">))</span>
</span>    <span class="n">N</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">R</span><span class="o">=</span><span class="n">N</span><span class="o">%</span><span class="mi">3</span>
    <span class="n">R</span><span class="o">=</span><span class="n">R</span> <span class="ow">and</span> <span class="mi">3</span><span class="o">-</span><span class="n">R</span>
    <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">R</span><span class="o">*</span><span class="sa">B</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span>
<span class="hll">    <span class="k">return</span> <span class="sa">B</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="o">*</span><span class="n">K</span><span class="p">,</span><span class="o">*</span><span class="n">W</span><span class="p">)</span> <span class="k">for</span> <span class="n">W</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">iter</span><span class="p">(</span><span class="n">M</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="sa">B</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">)</span>
</span></code></pre></div>
</td></tr></table>
<p>Lines 22/23 perform the encryption: the first 3 values of the plaintext bytes (<code>X</code>,
<code>Y</code>, and <code>Z</code>) multiplied by the first 3 bytes of the key (<code>A</code>, <code>B</code>, and <code>C</code>), added
together, then the lower 8 bits are returned for the first byte of the ciphertext. The
calculation is repeated with the same byte of plaintext <code>X</code> <code>Y</code> and <code>Z</code>, with the remaining
bytes of the key in sets of 3: <code>D</code> <code>E</code> <code>F</code>, and <code>G</code> <code>H</code> <code>I</code>.</p>
<p>On it's own, knowing the algorithm isn't enough to be able to decipher the messages. But
with the phrase <code>SPACEARMY</code> prepended to the message before encryption, we can use
that known plaintext with the first 9 bytes of the ciphertext to compute the key. Using the
nomenclature from the encryption routine, the computations work out like this:</p>
<div class="highlight"><pre><span></span><code>PT[] = Plaintext
CT[] = Ciphertext
A-I = bytes of the key, eg A = K[0], B = K[1], ...

CT[0] = ((A * PT[0]) + (B * PT[1]) + (C * PT[2])) &amp; 0xFF
CT[1] = ((D * PT[0]) + (E * PT[1]) + (F * PT[2])) &amp; 0xFF
CT[2] = ((G * PT[0]) + (H * PT[1]) + (I * PT[2])) &amp; 0xFF

CT[3] = ((A * PT[3]) + (B * PT[4]) + (C * PT[5])) &amp; 0xFF
CT[4] = ((D * PT[3]) + (E * PT[4]) + (F * PT[5])) &amp; 0xFF
CT[5] = ((G * PT[3]) + (H * PT[4]) + (I * PT[5])) &amp; 0xFF

CT[6] = ((A * PT[6]) + (B * PT[7]) + (C * PT[8])) &amp; 0xFF
CT[7] = ((D * PT[6]) + (E * PT[7]) + (F * PT[8])) &amp; 0xFF
CT[8] = ((G * PT[6]) + (H * PT[7]) + (I * PT[8])) &amp; 0xFF
...
</code></pre></div>
<p>Re-arranging the calculations to combine the common key values gives this:</p>
<div class="highlight"><pre><span></span><code>CT[0] = ((A * PT[0]) + (B * PT[1]) + (C * PT[2])) &amp; 0xFF
CT[3] = ((A * PT[3]) + (B * PT[4]) + (C * PT[5])) &amp; 0xFF
CT[6] = ((A * PT[6]) + (B * PT[7]) + (C * PT[8])) &amp; 0xFF

CT[1] = ((D * PT[0]) + (E * PT[1]) + (F * PT[2])) &amp; 0xFF
CT[4] = ((D * PT[3]) + (E * PT[4]) + (F * PT[5])) &amp; 0xFF
CT[7] = ((D * PT[6]) + (E * PT[7]) + (F * PT[8])) &amp; 0xFF

CT[2] = ((G * PT[0]) + (H * PT[1]) + (I * PT[2])) &amp; 0xFF
CT[5] = ((G * PT[3]) + (H * PT[4]) + (I * PT[5])) &amp; 0xFF
CT[8] = ((G * PT[6]) + (H * PT[7]) + (I * PT[8])) &amp; 0xFF
</code></pre></div>
<p>We have 3 equations, with 3 unknowns (<code>A B C</code>, <code>D E F</code>, <code>G H I</code>). The following Python code
takes reads the ciphertext from <code>stdin</code>, converts it from <code>hex</code> to <code>bytes</code>, then uses the 
known plaintext <code>SPACEARMY</code> to brute-force the key:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>

<span class="c1"># Decrypt SPACE JACKAL&#39;s encrypted messages</span>
<span class="c1">#</span>
<span class="c1"># Joe Ammond (pugpug), @joeammond</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Brute-force the solution to the equations:</span>
<span class="c1"># ((X * A) + (Y * B) + (Z * C)) &amp; 0xFF == v1</span>
<span class="c1"># ((X * D) + (Y * E) + (Z * F)) &amp; 0xFF == v2</span>
<span class="c1"># ((X * G) + (Y * H) + (Z * I)) &amp; 0xFF == v3</span>

<span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Solve 3 equations/3 unknowns. K = key, 9 bytes long&#39;&#39;&#39;</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="n">K</span>

    <span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">255</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">Y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">255</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">Z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">255</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">X</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">B</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">Z</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">C</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">==</span> <span class="n">v1</span> <span class="ow">and</span> \
                   <span class="p">((</span><span class="n">X</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">D</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">E</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">Z</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">F</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">==</span> <span class="n">v2</span> <span class="ow">and</span> \
                   <span class="p">((</span><span class="n">X</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">G</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">Z</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">==</span> <span class="n">v3</span><span class="p">:</span>
                       <span class="k">return</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>


<span class="c1"># Read the ciphertext from stdin, and convert from hex to bytes</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">C</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="c1"># Key array</span>
<span class="n">K</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="c1"># For each set of 3 key elements, solve for the known plaintext of &#39;SPACEARMY&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">],</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;SPACEARMY&#39;</span><span class="p">)</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">K</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">k1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">k2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">k3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Key values found:&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%02x</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">ord</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">()</span>
</code></pre></div>
<p>Piping in one of the cipher texts will reveal the bytes of the key used to encrypt the message:</p>
<div class="highlight"><pre><span></span><code>xps15$ python3 decrypt.py &lt; cipher1.txt
Key values found: cf 1c <span class="m">48</span> 4c df 8b 6d 0b <span class="m">46</span>
</code></pre></div>
<p>Now that we have the key used to encrypt the messages, we can use the same function to decrypt
the rest of the message. Adding the following to the program will decrypt and print the 
message:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Now we have the key, brute-force the message text from the ciphertext. Strip off the</span>
<span class="c1"># &#39;SPACEARMY&#39; header from the message first.</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">9</span><span class="p">:]</span>

<span class="c1"># Plaintext string</span>
<span class="n">P</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">for</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">iter</span><span class="p">(</span><span class="n">C</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">P</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">p3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
</code></pre></div>
<p>And now we can decrypt the 3 messages from the Deep Dark Web forum:</p>
<h3 id="message-1-welcome-on-board">Message 1: Welcome on board!<a class="headerlink" href="#message-1-welcome-on-board" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="go">xps15$ python3 decrypt.py &lt; cipher1.txt</span>
<span class="go">Key values found: cf 1c 48 4c df 8b 6d 0b 46</span>

<span class="go">Welcome on board and congratulations on joining the Order of 0x20.</span>

<span class="go">Together we will fight the good fight and bring enlightenment to the non-believers: Let&#39;s stop the global TAB infestation once and for all. This forum is a place to share news and coordinate action, but be careful: you never know who&#39;s watching.</span>

<span class="go"> 040 == 32 == 0x20</span>

<span class="go">-- admin.</span>
</code></pre></div>
<h3 id="message-2-lets-fight-back">Message 2: Let's fight back!<a class="headerlink" href="#message-2-lets-fight-back" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="go">xps15$ python3 decrypt.py &lt; cipher2.txt</span>
<span class="go">Key values found: cf 1c 48 4c df 8b 6d 0b 46</span>

<span class="go">My name is rudi. i was fired by my Old employer because I refused to use TABs. THIS madness must be STOPPED! These people must be STOPPED!1! But I fought back! I hacked their network established access. Let me know if you have an idea how to take revegne!</span>

<span class="go"> 040 == 32 == 0x20</span>

<span class="go">-- rudi.</span>
</code></pre></div>
<h3 id="message-3-flagz">Message 3: FLAGZ!<a class="headerlink" href="#message-3-flagz" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="go">xps15$ python3 decrypt.py &lt; cipher3.txt</span>
<span class="go">Key values found: cf 1c 48 4c df 8b 6d 0b 46</span>

<span class="go">Good job!</span>

<span class="go"> 040 == 32 == 0x20</span>

<span class="go">CS{if_computers_could_think_would_they_like_spaces?}</span>
</code></pre></div>
<h2 id="answer">Answer<a class="headerlink" href="#answer" title="Permanent link">#</a></h2>
<p><strong><code>CS{if_computers_could_think_would_they_like_spaces?}</code></strong></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../the-proclamation/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Space Jackal - The Proclamation
              </div>
            </div>
          </a>
        
        
          <a href="../injector/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Space Jackal - Injector
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Joe Ammond - <a href="http://twitter.com/joeammond">@joeammond</a>
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/joeammond" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/joeammond/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/joeammond" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.08c56446.min.js"></script>
      <script src="../../assets/javascripts/bundle.6ced434e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>